define(["text!templates/backend/applyList.html","../models/Apply","../models/ApplyCollection"],function(e,t,l){return openbiz.View.extend({app:"mainapp",el:".main",collection:l,events:{"click .btn-record-bh":"bh","click .btn-record-tg":"tg"},initialize:function(){return openbiz.View.prototype.initialize.call(this),this.collection=new l,this},fetchList:function(){this.collection.fetch({reset:!0})},bh:function(e){e.preventDefault();var t=this,l=$(e.currentTarget).attr("record-id"),i=this.collection.get(l);1==confirm("是否驳回?")&&i.bh(function(e,l){e&&(t.fetchList(),alert(l.message))})},tg:function(e){e.preventDefault();var t=this,l=$(e.currentTarget).attr("record-id"),i=this.collection.get(l);1==confirm("是否通过?")&&i.tg(function(e,l){e&&(t.fetchList(),alert(l.message))})},render:function(){var t=this;this.template=_.template(e),this.$el.html(this.template());var l=new Backgrid.Grid({columns:[{name:"username",label:"昵称",cell:"string",sortable:!1,editable:!1},{name:"realname",label:"真实姓名",cell:"string",sortable:!1,editable:!1},{name:"phone",label:"手机号",cell:"string",sortable:!1,editable:!1},{name:"weixin",label:"微信号",cell:"string",sortable:!1,editable:!1},{name:"fulltime",cell:Backgrid.UriCell.extend({render:function(){this.$el.empty();var e=this.model,t=parseFloat(e.get("fulltime")),l=1==t?"全职":"兼职";return this.$el.html(l),this}}),label:"工作状态",sortable:!1,editable:!1},{name:"work_year",label:"工作年限",cell:"string",sortable:!1,editable:!1},{name:"id",label:"操作",cell:Backgrid.UriCell.extend({render:function(){this.$el.empty();var e=this.model,l=e.get("_id"),i='<div class="tooltip-area"><a href="#" record-id="'+l+'"  class="btn btn-danger btn-sm btn-record-bh"><span><i class="glyphicon glyphicon-thumbs-down"></i>&nbsp; 驳回 &nbsp;</span></a><a href="#" record-id="'+l+'"  class="btn btn-success btn-sm btn-record-tg"><span><i class="glyphicon glyphicon-thumbs-up"></i>&nbsp; 通过 &nbsp;</span></a></div>';return this.$el.html(i),t.delegateEvents(),this}}),editable:!1,sortable:!1}],collection:this.collection,emptyText:"暂无数据",className:"table table-hover table-bordered text-center table-condensed"}),i=$("#admin");i.append(l.render().el);var n=new PageableCollection.Paginator({windowSize:10,slideScale:.25,goBackFirstOnSort:!1,collection:this.collection});return i.append(n.render().el),this.fetchList(),this}})});