define(["text!templates/backend/consultantList.html","../models/Consultant","../models/ConsultantCollection"],function(e,t,l){return openbiz.View.extend({app:"mainapp",el:".main",collection:l,events:{"click .btn-record-lh":"lh","click .introduction-content":"more"},initialize:function(){return openbiz.View.prototype.initialize.call(this),this.collection=new l,this},fetchList:function(){this.collection.fetch({reset:!0})},more:function(e){e.preventDefault();var t=$(e.currentTarget).attr("record-id"),l=this.collection.get(t),n=l.get("introduction");_.isUndefined(n)||_.isNull(n)||n.length>30&&($("body").data("newRecordData",n),this.popupView("backend.More"))},lh:function(e){return void e.preventDefault()},render:function(){var t=this;this.template=_.template(e),this.$el.html(this.template());var l=new Backgrid.Grid({columns:[{name:"username",label:"昵称",cell:"string",sortable:!1,editable:!1},{name:"realname",label:"真实姓名",cell:"string",sortable:!1,editable:!1},{name:"phone",label:"手机号",cell:"string",sortable:!1,editable:!1},{className:"introduction-cell",name:"introduction",label:"简介",cell:Backgrid.EmailCell.extend({render:function(){this.$el.empty();var e=this.model,l=e.get("introduction"),n=e.get("_id"),i='<div class="introduction-content" record-id="'+n+'">'+l+"</div>";return this.$el.html(i),t.delegateEvents(),this}}),editable:!1,sortable:!1},{name:"online_status",cell:Backgrid.UriCell.extend({render:function(){this.$el.empty();var e=this.model,t=parseFloat(e.get("online_status")),l=0==t?"在线":"离线";return this.$el.html(l),this}}),label:"在线状态",sortable:!1,editable:!1},{name:"id",label:"操作",cell:Backgrid.UriCell.extend({render:function(){this.$el.empty();var e=this.model,l=e.get("_id"),n='<div class="tooltip-area"><a href="#" record-id="'+l+'"  class="btn btn-sm btn-warning btn-record-lh"><span><i class="glyphicon glyphicon-eye-close"></i>&nbsp; 拉黑 &nbsp;</span></a></div>';return this.$el.html(n),t.delegateEvents(),this}}),editable:!1,sortable:!1}],collection:this.collection,emptyText:"暂无数据",className:"table table-hover table-bordered text-center table-condensed"}),n=$("#consultant");n.append(l.render().el);var i=new PageableCollection.Paginator({windowSize:10,slideScale:.25,goBackFirstOnSort:!1,collection:this.collection});return n.append(i.render().el),this.fetchList(),this}})});